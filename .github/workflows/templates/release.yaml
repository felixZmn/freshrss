name: Release Chart

on:
  workflow_call:

jobs:
  release:
  runs-on: ubuntu-latest
  steps:
    - name: Login to ghcr
      run: echo "${{ secrets.GITHUB_TOKEN }}" | helm registry login ghcr.io --username ${{ github.actor }} --password-stdin

    - name: Package Helm Chart
      run: helm package . --version ${{ env.TAG }}

    - name: Push Helm Chart to GHCR
      run: |
        helm push freshrss-*.tgz  oci://ghcr.io/${{ github.repository_owner }}/helm
